mutate('B' = str_count(seq, "B")) %>%
mutate('D' = str_count(seq, "D")) %>%
mutate('H' = str_count(seq, "H")) %>%
mutate('V' = str_count(seq, "V")) %>%
mutate('N' = str_count(seq, "N")) %>%
mutate('Z' = str_count(seq, "Z")) %>%
mutate('gap' = str_count(seq, "-"))
dat$non_actg <- rowSums(select(dat, U, W, S, M, K, R, Y, B, D, H, V, Z))
dat$n_gap <- rowSums(select(dat, N, gap))
dat$total <- rowSums(select(dat, U, W, S, M, K, R, Y, B, D, H, V, N, Z, gap))
dat <- select(dat, X1, A, C, G, 'T', U, W, S, M, K, R, Y, B, D, H, V, N, Z, gap, non_actg, n_gap, total, seq)
## Cross-tab of samples with non-ACTG
count(dat, U); count(dat, W); count(dat, S); count(dat, M); count(dat, K); count(dat, R); count(dat, Y); count(dat, B); count(dat, D); count(dat, H); count(dat, V); count(dat, N); count(dat, Z)
snpsites.raw <- read_tsv('~/Dropbox/src/MitoImpute/DerivedData/test/RefMtTest.vcf.gz', col_names = T, comment = "##")
python.raw <- read_tsv('~/Dropbox/src/MitoImpute/DerivedData/test/MT_Reference_decomposed.vcf.gz', col_names = T, comment = "##")
snpsites.raw
python.raw
unique(python.raw$POS)
table(unique(python.raw$POS))
length(unique(python.raw$POS))
length(unique(snpsites.raw$POS))
semi_join(python.raw, snpsites.raw, by = 'POS')
anti_join(python.raw, snpsites.raw, by = 'POS')
test1 <- read_tsv('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/Refence_panal.vcf.gz', comment = '##')
test1
test2 <- read_tsv('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/RefencePanel_NoAncients.vcf.gz', comment = '##')
test2
test1
test3 <- read_tsv('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/DerivedData/RefencePanel_NoAncients_Sapiens.vcf.gz', comment = '##')
test3 <- read_tsv('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/RefencePanel_NoAncients_Sapiens.vcf.gz', comment = '##')
test3
test2
test4 <- read_tsv('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/RefencePanel_NoAncients_Sapiens_NoPartials.vcf.gz', comment = '##')
test4
rm(test1)
rm(test2)
rm(test3)
rm(test4)
rm(test5)
dat
ancient <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/ancient.exclude_MOD.txt", col_names = T, comment = "##")
ancient <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/ancient.exclude_MOD.txt", col_names = F, comment = "##")
sapiens <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/ancient.exclude_MOD.txt", col_names = F, comment = "##")
partial <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/partial.exclude_MOD.txt", col_names = F, comment = "##")
ancient
partial
sapiens
sapiens <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/species.exclude_MOD.txt", col_names = F, comment = "##")
sapiens
ancient %>% full_join(sapiens) %>% full_join(partial)
ancient <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/ancient.exclude_MOD.txt", col_names = F, comment = "##") %>%
muatate(ancient = 1)
sapiens <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/species.exclude_MOD.txt", col_names = F, comment = "##") %>%
muatate(sapiens = 1)
partial <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/partial.exclude_MOD.txt", col_names = F, comment = "##") %>%
muatate(partial = 1)
ancient <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/ancient.exclude_MOD.txt", col_names = F, comment = "##") %>%
mutate(ancient = 1)
sapiens <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/species.exclude_MOD.txt", col_names = F, comment = "##") %>%
mutate(sapiens = 1)
partial <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/exclusion_lists/partial.exclude_MOD.txt", col_names = F, comment = "##") %>%
mutate(partial = 1)
ancient %>% full_join(sapiens) %>% full_join(partial)
test <- ancient %>% full_join(sapiens) %>% full_join(partial)
test
ancient
sapiens
partial
ancient %>% anti_join(sapiens)
ancient %>% full_join(sapiens)
ancient %>% anti_join(sapiens)
ancient
ancient %>% full_join(sapiens)
ancient %>% full_join(partial)
partial
ancient %>% full_join(partial)
partial
test
print(test, n = Inf)
dat
dat %>% semi_join(ancient)
dat %>% semi_join(sapiens)
dat %>% semi_join(partial)
dat %>% anti_join(partial)
dat %>% semi_join(partial)
partial
# Read in data
dat.fasta <- read_table(params$in_fasta, col_names = F)
##  Spread sequence names and sequecents
dat <- filter(dat.fasta, str_detect(X1, ">")); dat$X1 <- gsub('>', '', dat$X1)
dat$seq <- filter(dat.fasta, !str_detect(X1, ">"))$X1
dat
dat %>% semi_join(partial)
dat %>% anti_join(partial)
quality <- read_tsv("~/Dropbox/src/MitoImpute/scripts/INFORMATION_LISTS/ReferencePanel_highQualitySequences.txt", col_names = F, comment = "##") %>%
mutate(partial = 1)
quality
dat %>% anti_join(quality)
partial %>% anti_join(quality)
partial %>% semi_join(quality)
partial
partial %>% semi_join(quality)
list.files("/Users/sheaandrews/Documents/Test2/", pattern = "b37-strand.zip")
b37 <- list.files("/Users/sheaandrews/Documents/Test2/", pattern = "b37-strand.zip")
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/GSA-24v1-0_A1-b37-strand.zip"))
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/GSA-24v1-0_A1-b37-strand.zip"), col_names = F)
df
grep('MT', X2)
grep('MT', df$X2)
'MT' %in% df$X2
if('MT' %in% df$X2){
count(df, X2) %>% filter(X2 == 'MT')
}
df
if('MT' %in% df$X2){
count(df, X2) %>% filter(X2 == 'MT') %>% mutate(platform = 'foo')
}
lappy(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x))
if('MT' %in% df$X2){
count(df, X2) %>% filter(X2 == 'MT') %>% mutate(platform = 'foo')
} else {
NULL
}
})
lapply(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x))
if('MT' %in% df$X2){
count(df, X2) %>% filter(X2 == 'MT') %>% mutate(platform = 'foo')
} else {
NULL
}
})
test <- lapply(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x), col_names = F)
if('MT' %in% df$X2){
count(df, X2) %>% filter(X2 == 'MT') %>% mutate(platform = 'foo')
} else {
NULL
}
})
test
test <- lapply(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x), col_names = F)
if('MT' %in% df$X2){
count(df, X2) %>% filter(X2 == 'MT') %>% mutate(platform = x)
} else {
NULL
}
})
test
test <- lapply(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x), col_names = F)
if('MT' %in% df$X2){
count(df, X2) %>% filter(X2 == 'MT') %>% mutate(platform = x)
} else {
tibble(X2 = 'MT', n = 0, platform = x)
}
})
test
do.call(test, bind_rows())
do.call(test, bind_rows
do.call(test, bind_rows
)
do.call(test, bind_rows)
do.call(bind_rows, test)
print(test2, n = Inf)
test2 <- do.call(bind_rows, test)
print(test2, n = Inf)
test2 %>% arrange(n) %>% print(n = Inf)
test2 %>% arrange(-n) %>% print(n = Inf)
write_tsv('/Users/sheaandrews/Documents/Test2/MT_platforms.txt')
write_tsv(test2, '/Users/sheaandrews/Documents/Test2/MT_platforms.txt')
test <- lapply(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x), col_names = F)
if('MT' %in% df$X2){
df %>% filter(X2 == 'MT') %>% write_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x, "MT_snps.txt")
out <- count(df, X2) %>% filter(X2 == 'MT') %>% mutate(platform = x)
out
} else {
tibble(X2 = 'MT', n = 0, platform = x)
}
})
test <- lapply(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x), col_names = F)
if('MT' %in% df$X2){
df %>% filter(X2 == 'MT') %>% write_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x, "MT_snps.txt"))
out <- count(df, X2) %>% filter(X2 == 'MT') %>% mutate(platform = x)
out
} else {
tibble(X2 = 'MT', n = 0, platform = x)
}
})
test <- lapply(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x), col_names = F)
rename(df, SNP = X1, chr = X2, pos = X3, match = X4, strand = X5, TopAlleles = X6)
if('MT' %in% df$chr){
df %>% filter(chr == 'MT') %>% write_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x, "MT_snps.txt"))
out <- count(df, chr) %>% filter(chr == 'MT') %>% mutate(platform = x)
out
} else {
tibble(chr = 'MT', n = 0, platform = x)
}
})
b37 <- list.files("/Users/sheaandrews/Documents/Test2/", pattern = "b37-strand")
b37
b37 <- list.files("/Users/sheaandrews/Documents/Test2/", pattern = "b37.strand")
b37
b37 <- list.files("/Users/sheaandrews/Documents/Test2/", pattern = "*b37.strand")
b37
b37 <- list.files("/Users/sheaandrews/Documents/Test2/")
b37
grep('b37.strand', b37)
b37 <- list.files("/Users/sheaandrews/Documents/Test2/", pattern = "*.strand")
b37
filter(b37, grep('.zip', b37))
grep('.zip', b37)
b37[-grep('.zip', b37)]
b37 <- b37[-grep('.zip', b37)]
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/GSA-24v1-0_A1-b37-strand.zip"), col_names = F)
test <- lapply(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x), col_names = F)
rename(df, SNP = X1, chr = X2, pos = X3, match = X4, strand = X5)
if('MT' %in% df$chr){
df %>% filter(chr == 'MT') %>% write_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x, "_MT_snps.txt"))
out <- count(df, chr) %>% filter(chr == 'MT') %>% mutate(platform = x)
out
} else {
tibble(chr = 'MT', n = 0, platform = x)
}
})
read_tsv('Users/sheaandrews/Documents/Test2/HumanOmniExpressExome-8-v1-1-C-b37.strand', col_names = F)
read_tsv('Users/sheaandrews/Documents/Test2/HumanOmniExpressExome-8-v1-1-C-b37.strand', col_names = F)
read_tsv('/Users/sheaandrews/Documents/Test2/HumanOmni2-5-8-v1-2-A-b37.strand', col_names = F)
df.t <- read_tsv('/Users/sheaandrews/Documents/Test2/HumanOmni2-5-8-v1-2-A-b37.strand', col_names = F)
df.t
df.t <- read_tsv('/Users/sheaandrews/Documents/Test2/HumanOmni2-5-8-v1-2-A-b37.strand', col_names = F, col_types = 'ccnncc')
df.t
test <- lapply(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x), col_names = F, col_types = 'ccnncc')
rename(df, SNP = X1, chr = X2, pos = X3, match = X4, strand = X5)
if('MT' %in% df$chr){
df %>% filter(chr == 'MT') %>% write_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x, "_MT_snps.txt"))
out <- count(df, chr) %>% filter(chr == 'MT') %>% mutate(platform = x)
out
} else {
tibble(chr = 'MT', n = 0, platform = x)
}
})
warnings()
test
test2 <- do.call(bind_rows, test)
test2 %>% arrange(-n) %>% print(n = Inf)
test <- lapply(b37, function(x){
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x), col_names = F, col_types = 'ccnncc') %>%
rename(SNP = X1, chr = X2, pos = X3, match = X4, strand = X5)
if('MT' %in% df$chr){
df %>% filter(chr == 'MT') %>% write_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x, "_MT_snps.txt"))
out <- count(df, chr) %>% filter(chr == 'MT') %>% mutate(platform = x)
out
} else {
tibble(chr = 'MT', n = 0, platform = x)
}
cat(x, 'DONE \n')
})
test2 <- do.call(bind_rows, test)
test2 %>% arrange(-n) %>% print(n = Inf)
test
test <- lapply(b37, function(x){
cat(x, 'IN PROGRESS \n')
df <- read_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x), col_names = F, col_types = 'ccnncc') %>%
rename(SNP = X1, chr = X2, pos = X3, match = X4, strand = X5)
if('MT' %in% df$chr){
df %>% filter(chr == 'MT') %>% write_tsv(paste0("/Users/sheaandrews/Documents/Test2/", x, "_MT_snps.txt"))
out <- count(df, chr) %>% filter(chr == 'MT') %>% mutate(platform = x)
out
} else {
tibble(chr = 'MT', n = 0, platform = x)
}
})
test2 <- do.call(bind_rows, test)
test2 %>% arrange(-n) %>% print(n = Inf)
filter(test2, platform == 'Affy')
filter(test2, platform == 'Mapping')
filter(test2, platform %in% 'Mapping')
filter(test2, grep('Mapping', platform))
filter(test2, grep('Mapping', platform) == T)
grep('Mapping', test2$platform)
test2[grep('Mapping', test2$platform),]
test2[grep('Affy', test2$platform),]
test2[grep('Nsp', test2$platform),]
test2[grep('GenomeWideSNP', test2$platform),]
test2[grep('NSP', test2$platform),]
test2[grep('Sty', test2$platform),]
affy <- read_tsv('/Users/sheaandrews/Downloads/Nsp-Sty.na31-b37-strand.txt')
affy
count(affy, Chromosome)
filter(affy, Chromosme == '---')
filter(affy, Chromosome == '---')
affy %>% count(Chromosome) %>% print(n = Inf)
b37 <- list.files("/Users/sheaandrews/Dropbox/src/MitoImpute/")
b37
b37 <- list.files("/Users/sheaandrews/Dropbox/src/MitoImpute/data/")
b37
?list.dirs
list.dirs(path = "/Users/sheaandrews/Dropbox/src/MitoImpute/data/platforms", full.names = TRUE, recursive = TRUE)
list.dirs(path = "/Users/sheaandrews/Dropbox/src/MitoImpute/data/platforms", full.names = TRUE, recursive = F)
list.dirs(path = "/Users/sheaandrews/Dropbox/src/MitoImpute/data/platforms", full.names = TRUE, recursive = T)
list.dirs(path = "/Users/sheaandrews/Dropbox/src/MitoImpute/data/platforms", full.names = F, recursive = F)
b37 <- list.dirs(path = "/Users/sheaandrews/Dropbox/src/MitoImpute/data/platforms", full.names = TRUE, recursive = F)
b37
str_split(b37, "/")
b37
str_split(b37, "/", n =2)
str_split_fixed(b37, "/", n =2)
str_split_fixed
?str_split_fixed
str_split_fixed(b37, "platforms/", n =2)
str_split_fixed(b37, "platforms/", n =2)[,2]
b37 <- list.dirs(path = "/Users/sheaandrews/Dropbox/src/MitoImpute/data/platforms", full.names = TRUE, recursive = F)
b37.ls <- lapply(b37, function(x){
cat(x, 'IN PROGRESS \n')
df <- read_tsv(paste0(x, '/platform.strand'), col_names = F, col_types = 'ccnncc') %>%
rename(SNP = X1, chr = X2, pos = X3, match = X4, strand = X5)
if('MT' %in% df$chr){
platform <- str_split_fixed(x, "platforms/", n =2)[,2]
df %>% filter(chr == 'MT') %>% write_tsv(paste0("/Users/sheaandrews/Documents/Test2/", platform, "_MT_snps.txt"))
out <- count(df, chr) %>% filter(chr == 'MT') %>% mutate(platform = platform)
out
} else {
platform <- str_split_fixed(x, "platforms/", n =2)[,2]
out <- tibble(chr = 'MT', n = 0, platform = platform)
out
}
})
platforms <- do.call(bind_rows, test)
platforms
b37
platforms
platform.input <- str_split_fixed(b37, "platforms/", n =2)[,2]
platform.input
anti_join(platforms, platform.input)
tibble(platform.input)
anti_join(platforms, tibble(platform.input), by = c('?gsub'))
?gsub
gsub('.strand', "", platforms$platform)
platforms$platform <- gsub('.strand', "", platforms$platform)
platforms
anti_join(platforms, tibble(platform.input), by = c("platform" = 'platforms.input'))
tibble(platform.input)
anti_join(platforms, tibble(platform.input), by = c("platform" = 'platform.input'))
platforms %>% arrange(-n) %>% print(n = Inf)
b37
head(b37)
anti_join(platforms, tibble(platform.input), by = c("platform" = 'platform.input'))
grep('HumanCNV370v1_C', b37)
semi_join(platforms, tibble(platform.input), by = c("platform" = 'platform.input'))
115+11
platforms
platforms
platforms %>% arrange(-n) %>% print(n = Inf)
write_tsv(platforms %>% filter(n >1), '/Users/sheaandrews/Documents/Test2/Nsnps_Mt_platforms.txt')
write_tsv(platforms %>% arrange(-n), '/Users/sheaandrews/Documents/Test2/Nsnps_Mt_platforms.txt')
write_tsv(platforms %>% filter(n >1), '/Users/sheaandrews/Documents/Test2/Mt_platforms.txt')
write_tsv(platforms %>% filter(n >1) %>% select(platform), '/Users/sheaandrews/Documents/Test2/Mt_platforms.txt', col_names = F)
b37
read_tsv('/Users/sheaandrews/Documents/Test2/GSA-24v1-0_A2-b37_MT_snps.txt')
?unite
read_tsv('/Users/sheaandrews/Documents/Test2/GSA-24v1-0_A2-b37_MT_snps.txt') %>%
unite(chrpos, chr, pos, sep = ":")
read_tsv('/Users/sheaandrews/Documents/Test2/GSA-24v1-0_A2-b37_MT_snps.txt') %>%
unite(chrpos, chr, pos, sep = ":") %>%
write_tsv('/Users/sheaandrews/Documents/Test2/snplist.txt')
read_tsv('/Users/sheaandrews/Documents/Test2/GSA-24v1-0_A2-b37_MT_snps.txt') %>%
unite(chrpos, chr, pos, sep = ":") %>%
write_tsv('/Users/sheaandrews/Documents/Test2/snplist.txt', col_names = F)
read_tsv('/Users/sheaandrews/Documents/Test2/GSA-24v1-0_A2-b37_MT_snps.txt') %>%
unite(chrpos, chr, pos, sep = ":") %>%
select(chrpos) %>%
write_tsv('/Users/sheaandrews/Documents/Test2/snplist.txt', col_names = F)
read_tsv('/Users/sheaandrews/Documents/Test2/GSA-24v1-0_A2-b37_MT_snps.txt') %>%
rename(CHROM = chr, POS = pos) %>%
select(CHROM, POS) %>%
write_tsv('/Users/sheaandrews/Documents/Test2/snplist.txt', col_names = F)
b37
strand.file <- '/Users/sheaandrews/Dropbox/src/MitoImpute/data/platforms/BDCHP-1X10-HUMANHAP240S_11216501_A-b37/platform.strand'
strand.file
cat('IN PROGRESS: ', strand.file, '\n')
df <- read_tsv(strand.file, col_names = F, col_types = 'ccnncc') %>%
rename(SNP = X1, chr = X2, pos = X3, match = X4, strand = X5)
df
df
str_split_fixed(strand.file, "platforms/", n =2)[,2]
gsub('/platform.strand', '', strand.file)
gsub('platform.strand', '', strand.file)
str_split_fixed(out.dir, "platforms/", n =2)[,2]
out.dir <- gsub('platform.strand', '', strand.file)
str_split_fixed(out.dir, "platforms/", n =2)[,2]
out.dir <- gsub('/platform.strand', '', strand.file)
out.dir
platform <- str_split_fixed(out.dir, "platforms/", n =2)[,2]
platform
paste0(out.dir, "/", platform, "_MT_snps.txt")
if('MT' %in% df$chr){
out.dir <- gsub('/platform.strand', '', strand.file)
platform <- str_split_fixed(out.dir, "platforms/", n =2)[,2]
df %>%
filter(chr == 'MT') %>%
rename(CHROM = chr, POS = pos) %>%
select(CHROM, POS) %>%
write_tsv(paste0(out.dir, "/", platform, "_MT_snps.txt"))
} else {
out.dir <- gsub('platform.strand', '', strand.file)
df %>%
filter(chr == 'MT') %>%
rename(CHROM = chr, POS = pos) %>%
select(CHROM, POS) %>%
write_tsv(paste0(out.dir, "/", platform, "_MT_snps.txt"))
}
if('MT' %in% df$chr){
out.dir <- gsub('/platform.strand', '', strand.file)
platform <- str_split_fixed(out.dir, "platforms/", n =2)[,2]
df %>%
filter(chr == 'MT') %>%
rename(CHROM = chr, POS = pos) %>%
select(CHROM, POS) %>%
write_tsv(paste0(out.dir, "/", platform, "_MT_snps.txt"))
} else {
out.dir <- gsub('platform.strand', '', strand.file)
df %>%
filter(chr == 'MT') %>%
rename(CHROM = chr, POS = pos) %>%
select(CHROM, POS) %>%
write_tsv(paste0(out.dir, "/", platform, "_MT_snps.txt"))
}
out.file <- 'data/platforms/HumanOmni5Exome-4v1-1_A-b37/HumanOmni5Exome-4v1-1_A-b37_MT_snps.txt'
strand.file <- 'data/platforms/HumanOmni5Exome-4v1-1_A-b37/platform.strand'
cat('IN PROGRESS: ', strand.file, '\n')
read_tsv(strand.file, col_names = F, col_types = 'ccnncc') %>%
rename(SNP = X1, CHROM = X2, POS = X3, match = X4, strand = X5) %>%
filter(CHROM == 'MT') %>%
select(CHROM, POS)
setwd('/Users/sheaandrews/Dropbox/src/MitoImpute')
read_tsv(strand.file, col_names = F, col_types = 'ccnncc') %>%
rename(SNP = X1, CHROM = X2, POS = X3, match = X4, strand = X5) %>%
filter(CHROM == 'MT') %>%
select(CHROM, POS)
read_tsv(strand.file, col_names = F, col_types = 'ccnncc') %>%
rename(SNP = X1, CHROM = X2, POS = X3, match = X4, strand = X5) %>%
filter(CHROM == 'MT') %>%
select(CHROM, POS) %>%
write_tsv(out.file)
out.file
rwd = /Users/sheaandrews/Dropbox/src/MitoImpute
rwd = '/Users/sheaandrews/Dropbox/src/MitoImpute'
b37 <- list.dirs(path = paste0(rwd, "/data/platforms"), full.names = TRUE, recursive = F)
b37
b37.ls <- lapply(b37, function(x){
cat('IN PROGRESS: ', x, '\n')
df <- read_tsv(paste0(x, '/platform.strand'), col_names = F, col_types = 'ccnncc') %>%
rename(SNP = X1, chr = X2, pos = X3, match = X4, strand = X5)
if('MT' %in% df$chr){
platform <- str_split_fixed(x, "platforms/", n =2)[,2]
out <- count(df, chr) %>% filter(chr == 'MT') %>% mutate(platform = platform)
out
} else {
platform <- str_split_fixed(x, "platforms/", n =2)[,2]
out <- tibble(chr = 'MT', n = 0, platform = platform)
out
}
})
platforms <- do.call(bind_rows, b37.ls)
platforms
b37.ls <- lapply(b37, function(x){
cat('IN PROGRESS: ', x)
df <- read_tsv(paste0(x, '/platform.strand'), col_names = F, col_types = 'ccnncc') %>%
rename(SNP = X1, chr = X2, pos = X3, match = X4, strand = X5)
if('MT' %in% df$chr){
platform <- str_split_fixed(x, "platforms/", n =2)[,2]
out <- count(df, chr) %>% filter(chr == 'MT') %>% mutate(platform = platform)
cat('\t DONE \n'); out
} else {
platform <- str_split_fixed(x, "platforms/", n =2)[,2]
out <- tibble(chr = 'MT', n = 0, platform = platform)
cat('\t DONE \n'); out
}
})
b37.ls
dat <- read_tsv('/Users/sheaandrews/Dropbox/src/MitoImpute/data/platforms/Nsnps_Mt_platforms.txt')
dat
print(dat, n = Inf)
read_tsv('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/ThousandGenomes/GSAMD-24v2-0_20024620_A1-b37/chrMT_1kg_GSAMD-24v2-0_20024620_A1-b37.samples')
read_tsv('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/ReferencePanel/ReferencePanel.samples')
read_table('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/ReferencePanel/ReferencePanel.samples')
read_delim('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/ReferencePanel/ReferencePanel.samples', delim = " ")
dat[1,4]
dat[1,3]
dat <- read_delim('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/ReferencePanel/ReferencePanel.samples', delim = " ")
dat <- dat[1,4]
dat <- read_delim('/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/ReferencePanel/ReferencePanel.samples', delim = " ")
dat[1,4]
dat[1,4] <- "D"
dat
?write.table
file.path <- /Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/ThousandGenomes/GSAMD-24v2-0_20024620_A1-b37/chrMT_1kg_GSAMD-24v2-0_20024620_A1-b37.samples
file.path <- '/Users/sheaandrews/Dropbox/src/MitoImpute/DerivedData/ThousandGenomes/GSAMD-24v2-0_20024620_A1-b37/chrMT_1kg_GSAMD-24v2-0_20024620_A1-b37.samples'
dat <- read_delim(file.path, delim = " ", col_names = F)
dat
dat <- read_delim(file.path, delim = " ", col_names = T)
dat
dat[1,4] <- "D"
dat
